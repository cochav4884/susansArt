<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Art Gallery</title>

  <link rel="icon" type="image/png" href="public/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="public/favicon.svg" />
<link rel="shortcut icon" href="public/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="public/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="susansArt" />
<link rel="manifest" href="public/site.webmanifest" />


 <link rel="stylesheet" href="styles/index.css">
  <link rel="stylesheet" href="styles/art.css">
 
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    <header class="nav">
    <a href="index.html" class="back-btn">
        <img src="public/favicon.ico" alt="Art Tracker Logo" class="nav-avatar"></a>
    <span class="nav-brand">üé® Art Gallery</span>
   </header>

  <section class="jumbotron">
  <div>
    <img src="images/susan.jpg" alt="Picture of Artist Susan" class="jumbotron-avatar">
    <h1>Artist: Susan</h1>
    <p>Track every art project from idea to completion.</p>
  </div>
</section>

  <main class="reading-container">
    <h1 class="book-title">Select or Upload Final Artwork</h1>

    <!-- Dropdown -->
    <div>
      <label for="artDropdown">Choose Artwork:</label>
      <select id="artDropdown" class="form-select"></select>
      <button type="button" id="deleteArtwork">üóëÔ∏è Delete Artwork</button>
    </div>

    <!-- Upload Images -->
    <div class="upload-section">
      <label for="uploadArt">Upload Images for Selected Artwork:</label>
      <input type="file" id="uploadArt" accept="image/*" multiple>
    </div>

    <!-- Art Display Area -->
    <div class="art-viewer" id="artViewer"></div>

    <!-- Add new artwork -->
    <div class="new-artwork">
      <input type="text" id="newArtTitle" placeholder="New artwork title">
      <button type="button" id="addArtwork">‚ûï Add Artwork</button>
    </div>
  </main>

  <footer class="site-footer">
    <p>Artist: Susan | <span id="year"></span></p>
    <p>
      <a href="privacyPolicy.html">Privacy Policy</a> |
      <a href="legalDisclaimer.html">Legal Disclaimer</a>
    </p>
  </footer>

<script>
  const STORAGE_KEY = "finalArtGallery";

  function loadArt() {
    const data = localStorage.getItem(STORAGE_KEY);
    return data ? JSON.parse(data) : [];
  }

  function saveArt(artArray) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(artArray));
  }

  const artDropdown = document.getElementById("artDropdown");
  const artViewer = document.getElementById("artViewer");
  const uploadArt = document.getElementById("uploadArt");
  const newArtTitle = document.getElementById("newArtTitle");
  const addArtworkBtn = document.getElementById("addArtwork");
  const deleteArtworkBtn = document.getElementById("deleteArtwork");

  let artData = loadArt();

  function populateDropdown() {
    artDropdown.innerHTML = "";
    if(artData.length === 0){
      const option = document.createElement("option");
      option.textContent = "-- No Artwork --";
      option.value = "";
      artDropdown.appendChild(option);
      return;
    }
    const placeholder = document.createElement("option");
    placeholder.textContent = "-- Select Artwork --";
    placeholder.value = "";
    artDropdown.appendChild(placeholder);

    artData.forEach((art, index)=>{
      const option = document.createElement("option");
      option.textContent = art.title;
      option.value = index;
      artDropdown.appendChild(option);
    });
  }

  function displayImages(index) {
    artViewer.innerHTML = "";
    if(index === "" || !artData[index] || artData[index].images.length === 0){
      artViewer.innerHTML = "<p>No images uploaded for this artwork yet.</p>";
      return;
    }
    artData[index].images.forEach((imgSrc, i)=>{
      const container = document.createElement("div");
      container.className = "art-image-container";

      const img = document.createElement("img");
      img.src = imgSrc;

      const delBtn = document.createElement("button");
      delBtn.textContent = "‚ùå";
      delBtn.title = "Delete this image";
      delBtn.onclick = ()=>{
        if(confirm("Delete this image?")){
          artData[index].images.splice(i,1);
          saveArt(artData);
          displayImages(index);
        }
      };

      container.appendChild(img);
      container.appendChild(delBtn);
      artViewer.appendChild(container);
    });
  }

  artDropdown.addEventListener("change", e=>{
    displayImages(e.target.value);
  });

  // Upload multiple images
  uploadArt.addEventListener("change", e=>{
    const files = Array.from(e.target.files);
    const selectedIndex = artDropdown.value;
    if(selectedIndex === ""){
      alert("Please select an artwork first.");
      uploadArt.value = "";
      return;
    }
    files.forEach(file=>{
      const reader = new FileReader();
      reader.onload = ev=>{
        artData[selectedIndex].images.push(ev.target.result);
        saveArt(artData);
        displayImages(selectedIndex);
      };
      reader.readAsDataURL(file);
    });
    uploadArt.value = "";
  });

  // Add new artwork
  addArtworkBtn.addEventListener("click", ()=>{
    const title = newArtTitle.value.trim();
    if(!title){
      alert("Enter a title for the new artwork.");
      return;
    }
    artData.push({title, images: []});
    saveArt(artData);
    newArtTitle.value = "";
    populateDropdown();
  });

  // Delete entire artwork
  deleteArtworkBtn.addEventListener("click", ()=>{
    const selectedIndex = artDropdown.value;
    if(selectedIndex === ""){
      alert("Please select an artwork first.");
      return;
    }
    if(confirm(`Delete the artwork "${artData[selectedIndex].title}" and all its images?`)){
      artData.splice(selectedIndex,1);
      saveArt(artData);
      populateDropdown();
      artViewer.innerHTML = "<p>No images uploaded for this artwork yet.</p>";
    }
  });

  // Initialize
  populateDropdown();
  if(artData.length>0) displayImages(0);


  /* Year */
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

</body>
</html>